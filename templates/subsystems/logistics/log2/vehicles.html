{% extends "base/subsystem_base.html" %}

{% block header_title %}Vehicle Management{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header Actions -->
    <div class="flex justify-between items-center bg-white p-6 rounded-2xl shadow-sm border border-gray-100">
        <div>
            <h3 class="text-xl font-bold text-gray-900">Vehicle Fleet</h3>
            <p class="text-gray-500 text-sm">Manage and monitor all hospital vehicles</p>
        </div>
        <button onclick="document.getElementById('addVehicleModal').classList.remove('hidden')"
            class="px-4 py-2 bg-[#F97316] text-white font-bold rounded-xl hover:bg-[#EA580C] transition-colors flex items-center space-x-2">
            <i class="bi bi-plus-lg"></i>
            <span>Add Vehicle</span>
        </button>
    </div>

    <!-- Vehicles Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for vehicle in vehicles %}
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow">
            <div class="p-6">
                <div class="flex justify-between items-start mb-4">
                    <div class="w-12 h-12 rounded-xl bg-gray-50 flex items-center justify-center text-[#F97316]">
                        <i class="bi bi-truck text-2xl"></i>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs font-bold 
                        {% if vehicle.status == 'Available' %}bg-green-100 text-green-700
                        {% elif vehicle.status == 'In Use' %}bg-blue-100 text-blue-700
                        {% else %}bg-red-100 text-red-700{% endif %}">
                        {{ vehicle.status }}
                    </span>
                </div>
                
                <h4 class="text-lg font-bold text-gray-900 mb-1">{{ vehicle.vehicle_type }} - {{ vehicle.model_name }}</h4>
                <p class="text-gray-500 font-mono text-sm mb-4">{{ vehicle.plate_number }}</p>

                <div class="grid grid-cols-2 gap-4 border-t border-gray-50 pt-4">
                    <div>
                        <p class="text-xs text-gray-400 uppercase font-bold tracking-wider">Type</p>
                        <p class="text-sm font-semibold text-gray-700">{{ vehicle.vehicle_type }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-400 uppercase font-bold tracking-wider">Last Service</p>
                        <p class="text-sm font-semibold text-gray-700">{{ vehicle.last_service_date or 'N/A' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-between items-center text-xs text-gray-500">
                <span>Created: {% if vehicle.created_at %}{{ vehicle.created_at[:10] }}{% else %}N/A{% endif %}</span>
                <div class="flex space-x-2">
                    <button class="hover:text-[#F97316]" title="Edit"><i class="bi bi-pencil-square"></i></button>
                    <button class="hover:text-red-600" title="Delete"><i class="bi bi-trash"></i></button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Add Vehicle Modal -->
    <div id="addVehicleModal" class="hidden fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl w-full max-w-md overflow-hidden">
            <div class="px-8 py-6 border-b border-gray-100 flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-900">Add New Vehicle</h3>
                <button onclick="document.getElementById('addVehicleModal').classList.add('hidden')" class="text-gray-400 hover:text-gray-600">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <form action="{{ url_for('log2.add_vehicle') }}" method="POST" class="p-8 space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Vehicle Type</label>
                        <select name="vehicle_type" required class="w-full px-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#F97316] outline-none">
                            <option value="Ambulance">Ambulance</option>
                            <option value="Medical Transport">Medical Transport</option>
                            <option value="Utility Van">Utility Van</option>
                            <option value="Staff Shuttle">Staff Shuttle</option>
                        </select>
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Vehicle Model</label>
                        <input type="text" name="model_name" required placeholder="Toyota Hiace" class="w-full px-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#F97316] outline-none">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-1">License Plate (Plate Number)</label>
                        <input type="text" name="plate_number" required placeholder="ABC-1234" class="w-full px-4 py-2 border border-gray-200 rounded-xl focus:ring-2 focus:ring-[#F97316] outline-none">
                    </div>
                </div>
                <button type="submit" class="w-full py-3 bg-[#F97316] text-white font-bold rounded-xl hover:bg-[#EA580C] shadow-lg transition-all mt-4">
                    Register Vehicle
                </button>
            </form>
        </div>
    </div>
</div>
{% endblock %}
